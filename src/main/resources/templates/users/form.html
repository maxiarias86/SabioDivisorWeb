<!DOCTYPE html>
<html lang="es" xmlns:th="http://www.thymeleaf.org">

<head>
    <meta charset="UTF-8">
    <script src="https://cdn.tailwindcss.com"></script>
    <title>Registro de Usuario</title>
</head>

<body class="h-screen flex items-center justify-center bg-blue-100">
<div class="bg-white p-8 rounded-lg shadow-md w-full max-w-md">

    <h1 class="text-2xl font-bold text-center mb-6 text-blue-900"
        th:if="${user.id != null}">Edición de Usuario</h1>

    <h1 class="text-2xl font-bold text-center mb-6 text-blue-900"
        th:if="${user.id == null}">Registro de Usuario</h1>


    <div class="hidden text-red-800 p-2 mb-4 text-sm text-center"
         id="passwordError">Las contraseñas no coinciden.
    </div>

    <div th:if="${error}"
         class="text-red-800 p-2 mb-4 text-sm text-center">
        <p th:text="${error}">Mensaje de error</p>
    </div>

    <!-- th:object="${user}": Los campos del formulario se vinculan al objeto user de model.addAttribute("user", new AppUser()) en el Controller -->
    <form th:action="@{/users/save}" th:object="${user}" method="post" class="space-y-4"
          onsubmit="return validatePasswords()"><!-- Valida que las contraseñas coincidan con JS-->

        <input type="hidden" th:field="*{id}" />

        <div class="flex flex-col">
            <label for="name" class="text-md font-medium text-blue-900">Nombre:</label>
            <input type="text" id="name" th:field="*{name}" required class="bg-gray-100 rounded p-2" />
        </div>

        <div class="flex flex-col">
            <label for="email" class="text-md font-medium text-blue-900">Email:</label>
            <input type="email" id="email" th:field="*{email}" required class="bg-gray-100 rounded p-2" />
        </div>

        <div class="flex flex-col">
            <label for="password" class="text-md font-medium text-blue-900">Contraseña:</label>
            <input type="password" id="password" th:field="*{password}" required class="bg-gray-100 rounded p-2" />
        </div>

        <div class="flex flex-col">
            <label for="confirmPassword" class="text-md font-medium text-blue-900">Confirmar contraseña:</label>
            <input type="password" id="confirmPassword" required class="bg-gray-100 rounded p-2" />
        </div>

        <div class="flex justify-center">
            <button type="submit"
                    class="bg-blue-500 text-white px-4 py-2 rounded hover:bg-blue-700 transition">
                Registrarse
            </button>
        </div>

    </form>

    <div class="text-sm text-center mt-4">
        ¿Ya tenés cuenta?
        <a th:href="@{/login}" class="text-blue-700 hover:underline">Iniciar sesión</a>
    </div>
</div>

<script>
    function validatePasswords() {
        const pass = document.getElementById("password").value;
        const confirm = document.getElementById("confirmPassword").value;
        const error = document.getElementById("passwordError");

        if (pass !== confirm) {
            error.classList.remove("hidden");
            return false;
        }
        error.classList.add("hidden");
        return true;
    }
</script>

</body>
</html>
